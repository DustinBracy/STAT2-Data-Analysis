---
title: "Data Analysis Project"
author: "Sabrina, Dustin and Huy"
date: "3/11/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
```

## R Markdown

Suggested Downtime Activities:  

1. Data cleaning (handle missing?,  train/test split logistics:  you want a good balance of Y/N in your train)
2. summary statistics (the ones I kept complaining about on Project 1)
3. EDA (basic boxplots, scatterplots, bar charts etc to see how things relate to the response, PCA tool),
4. Maybe play around and fit a few LDA models with continuous stuff.


```{r}
#reading in 'Bank Additional' file
bank = read.csv("./DataSets/bank-additional.csv",header = TRUE, sep = ";")
str(bank)
summary(bank)
sum(is.na(bank))
```

```{r}
#reading in 'Bank Additional Full' file
bankfull = read.csv("./DataSets/bank-additional-full.csv",header = TRUE, sep = ";")
str(bankfull)
summary(bankfull)
sum(is.na(bankfull))
```


```{r EDA}
bank %>% ggplot(aes(age, y)) + geom_boxplot()
bank %>% ggplot(aes(job, y, fill=y)) + geom_col()
bank %>% ggplot(aes(marital, y, fill=y)) + geom_col()
bank %>% ggplot(aes(education, y,  fill=y)) + geom_col()
bank %>% ggplot(aes(default, y,  fill=y)) + geom_col()


```





```{r LDA analysis}

# Select only continuous variables:
bankCont <- dplyr::select(bankfull, c('age','duration', 'campaign', 'pdays', 'cons.price.idx', 'cons.conf.idx', 'euribor3m', 'nr.employed','y'))
bankCont$age <- as.numeric(bankCont$age)
bankCont$duration <- as.numeric(bankCont$duration)
bankCont$campaign <- as.numeric(bankCont$campaign)
bankCont$pdays <- as.numeric(bankCont$pdays)


mylda<-lda(y~age+duration+ campaign+ pdays+ cons.price.idx+ cons.conf.idx+ euribor3m+ nr.employed, data=bankCont)
pred<-predict(mylda,newdata=bankCont)$class  #Predictions can come in many forms, the class form provides the categorical level of your response.
Truth<-bankCont$y
x<-table(pred,Truth) # Creating a confusion matrix
x
#Missclassification Error
ME<-(x[2,1]+x[1,2])/1000
ME

```


```{r PCA Analysis}

pc.bankCont<-prcomp(bankCont[,-9],scale.=TRUE)
pc.bankCont.scores<-pc.bankCont$x

#Adding the response column to the PC's data frame
pc.bankCont.scores<-data.frame(pc.bankCont.scores)
pc.bankCont.scores$y<-bankCont$y

pc.bankCont.scores

#Use ggplot2 to plot the first few pc's
ggplot(data = pc.bankCont.scores, aes(x = PC1, y = PC2)) +
  geom_point(aes(col=y), size=1)+
  ggtitle("PCA of Subscriptions")

ggplot(data = pc.bankCont.scores, aes(x = PC2, y = PC3)) +
  geom_point(aes(col=y), size=1)+
  ggtitle("PCA of Subscriptions")


```







